{"version":3,"file":"index.js","sources":["../src/useObjectFit.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\n\n/**\n * @param {object} {\n *   type, // \"cover\", \"contain\"\n *   imgUrl,\n *   container: {\n *      ref, // get container size by React ref\n *      dom, // get container size by Dom elm\n *      width, // directly give container size\n *      height\n *   },\n * }\n * @return {object} {\n *    width, // object fit width\n *    height, // object fit hight\n *    offsetX, // object fit offsetX\n *    offsetY, // object fit offsetY\n *    ratio, // origin image ratio\n *    imgWidth,\n *    imgHeight,\n *    containerWidth,\n *    containerHeight,\n * }\n */\nconst useObjectFit = ({\n  type,\n  imgUrl,\n  container: { ref, dom, width: containerWidth, height: containerHeight },\n}) => {\n  const [size, setSize] = useState({\n    width: 0,\n    height: 0,\n    ratio: 0,\n    offsetX: 0,\n    offsetY: 0,\n    imgWidth: 0,\n    imgHeight: 0,\n    containerWidth: 0,\n    containerHeight: 0,\n  });\n\n  useEffect(() => {\n    const targetContainer = ref?.current || dom;\n    const targetWidth = containerWidth || targetContainer?.clientWidth;\n    const targetHeight = containerHeight || targetContainer?.clientHeight;\n    const targetRatio = targetWidth / targetHeight;\n\n    if (!imgUrl) return;\n    const img = document.createElement(\"img\");\n    img.addEventListener(\"load\", (e) => {\n      const { naturalHeight, naturalWidth } = e.target;\n      console.log(naturalWidth, naturalHeight);\n      const ratio = naturalWidth / naturalHeight;\n      let width,\n        height,\n        offsetX = 0,\n        offsetY = 0;\n\n      if (type === \"cover\") {\n        if (ratio >= targetRatio) {\n          const scale = containerHeight / naturalHeight;\n          width = naturalWidth * scale;\n          offsetX = (containerWidth - width) / 2;\n          height = containerHeight;\n        } else {\n          const scale = containerWidth / naturalWidth;\n          width = containerWidth;\n          height = naturalHeight * scale;\n          offsetY = (containerHeight - height) / 2;\n        }\n      } else if (type === \"contain\") {\n        if (ratio >= targetRatio) {\n          const scale = containerWidth / naturalWidth;\n          width = containerWidth;\n          height = naturalHeight * scale;\n\n          offsetY = (containerHeight - height) / 2;\n        } else {\n          const scale = containerHeight / naturalHeight;\n          height = containerHeight;\n          width = naturalWidth * scale;\n          offsetX = (containerWidth - width) / 2;\n        }\n      }\n\n      setSize({\n        width,\n        height,\n        ratio,\n        offsetX,\n        offsetY,\n        imgWidth: naturalWidth,\n        imgHeight: naturalHeight,\n        containerWidth,\n        containerHeight,\n      });\n    });\n    img.src = imgUrl;\n  }, [type, imgUrl, ref, dom, containerWidth, containerHeight]);\n\n  return size;\n};\n\nexport default useObjectFit;\n"],"names":["type","imgUrl","container","ref","dom","containerWidth","width","containerHeight","height","useState","ratio","offsetX","offsetY","imgWidth","imgHeight","size","setSize","useEffect","targetContainer","current","targetRatio","clientWidth","clientHeight","img","document","createElement","addEventListener","e","target","naturalHeight","naturalWidth","console","log","src"],"mappings":"mgCAyBqB,gBACnBA,IAAAA,KACAC,IAAAA,WACAC,UAAaC,IAAAA,IAAKC,IAAAA,IAAYC,IAAPC,MAA+BC,IAARC,WAEtBC,WAAS,CAC/BH,MAAO,EACPE,OAAQ,EACRE,MAAO,EACPC,QAAS,EACTC,QAAS,EACTC,SAAU,EACVC,UAAW,EACXT,eAAgB,EAChBE,gBAAiB,OATZQ,OAAMC,cAYbC,aAAU,eACFC,GAAkBf,MAAAA,SAAAA,EAAKgB,UAAWf,EAGlCgB,GAFcf,IAAkBa,MAAAA,SAAAA,EAAiBG,eAClCd,IAAmBW,MAAAA,SAAAA,EAAiBI,kBAGpDrB,OACCsB,EAAMC,SAASC,cAAc,OACnCF,EAAIG,iBAAiB,QAAQ,SAACC,SACYA,EAAEC,OAAlCC,IAAAA,cAAeC,IAAAA,aACvBC,QAAQC,IAAIF,EAAcD,OAEtBvB,EACFE,EAFIE,EAAQoB,EAAeD,EAG3BlB,EAAU,EACVC,EAAU,KAEC,UAATZ,EACEU,GAASU,GAGXT,GAAWN,GADXC,EAAQwB,GADMvB,EAAkBsB,KAEK,EACrCrB,EAASD,IAGTD,EAAQD,EAERO,GAAWL,GADXC,EAASqB,GAFKxB,EAAiByB,KAGQ,QAEpC,GAAa,YAAT9B,EAAoB,IACzBU,GAASU,EAEXd,EAAQD,EAGRO,GAAWL,GAFXC,EAASqB,GAFKxB,EAAiByB,KAIQ,OAGvCtB,EAASD,EAETI,GAAWN,GADXC,EAAQwB,GAFMvB,EAAkBsB,KAGK,EAIzCb,EAAQ,CACNV,MAAAA,EACAE,OAAAA,EACAE,MAAAA,EACAC,QAAAA,EACAC,QAAAA,EACAC,SAAUiB,EACVhB,UAAWe,EACXxB,eAAAA,EACAE,gBAAAA,OAGJgB,EAAIU,IAAMhC,KACT,CAACD,EAAMC,EAAQE,EAAKC,EAAKC,EAAgBE,IAErCQ"}