{"version":3,"file":"index.js","sources":["../src/useObjectFit.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\n\n/**\n * @param {object} {\n *   type, // \"cover\", \"contain\"\n *   imgUrl,\n *   container: {\n *      ref, // get container size by React ref\n *      dom, // get container size by Dom elm\n *      width, // directly give container size\n *      height\n *   },\n * }\n * @return {object} {\n *    width, // object fit width\n *    height, // object fit hight\n *    offsetX, // object fit offsetX\n *    offsetY, // object fit offsetY\n *    ratio, // origin image ratio\n *    imgWidth,\n *    imgHeight,\n *    containerWidth,\n *    containerHeight,\n * }\n */\nconst useObjectFit = ({\n  type,\n  imgUrl,\n  container: { ref, dom, width: containerWidth, height: containerHeight },\n}) => {\n  const [size, setSize] = useState({\n    width: 0,\n    height: 0,\n    ratio: 0,\n    offsetX: 0,\n    offsetY: 0,\n    imgWidth: 0,\n    imgHeight: 0,\n    containerWidth: 0,\n    containerHeight: 0,\n  });\n\n  useEffect(() => {\n    const targetContainer = ref?.current || dom;\n    console.log(targetContainer);\n    const targetWidth = containerWidth || targetContainer?.clientWidth;\n    const targetHeight = containerHeight || targetContainer?.clientHeight;\n    console.log(targetWidth, targetHeight);\n    const targetRatio = targetWidth / targetHeight;\n\n    if (!imgUrl) return;\n    const img = document.createElement(\"img\");\n    img.addEventListener(\"load\", (e) => {\n      const { naturalHeight, naturalWidth } = e.target;\n      console.log(naturalWidth, naturalHeight);\n      const ratio = naturalWidth / naturalHeight;\n      let width,\n        height,\n        offsetX = 0,\n        offsetY = 0;\n\n      if (type === \"cover\") {\n        if (ratio >= targetRatio) {\n          const scale = targetHeight / naturalHeight;\n          console.log(scale);\n          width = naturalWidth * scale;\n          offsetX = (targetWidth - width) / 2;\n          height = targetHeight;\n        } else {\n          const scale = targetWidth / naturalWidth;\n          width = targetWidth;\n          height = naturalHeight * scale;\n          offsetY = (targetHeight - height) / 2;\n        }\n      } else if (type === \"contain\") {\n        if (ratio >= targetRatio) {\n          const scale = targetWidth / naturalWidth;\n          width = targetWidth;\n          height = naturalHeight * scale;\n\n          offsetY = (targetHeight - height) / 2;\n        } else {\n          const scale = targetHeight / naturalHeight;\n          height = targetHeight;\n          width = naturalWidth * scale;\n          offsetX = (targetWidth - width) / 2;\n        }\n      }\n\n      setSize({\n        width,\n        height,\n        ratio,\n        offsetX,\n        offsetY,\n        imgWidth: naturalWidth,\n        imgHeight: naturalHeight,\n        containerWidth: targetWidth,\n        containerHeight: targetHeight,\n      });\n    });\n    img.src = imgUrl;\n  }, [type, imgUrl, ref, dom, containerWidth, containerHeight]);\n\n  return size;\n};\n\nexport default useObjectFit;\n"],"names":["type","imgUrl","container","ref","dom","containerWidth","width","containerHeight","height","useState","ratio","offsetX","offsetY","imgWidth","imgHeight","size","setSize","useEffect","targetContainer","current","console","log","targetWidth","clientWidth","targetHeight","clientHeight","targetRatio","img","document","createElement","addEventListener","e","target","naturalHeight","naturalWidth","scale","src"],"mappings":"mgCAyBqB,gBACnBA,IAAAA,KACAC,IAAAA,WACAC,UAAaC,IAAAA,IAAKC,IAAAA,IAAYC,IAAPC,MAA+BC,IAARC,WAEtBC,WAAS,CAC/BH,MAAO,EACPE,OAAQ,EACRE,MAAO,EACPC,QAAS,EACTC,QAAS,EACTC,SAAU,EACVC,UAAW,EACXT,eAAgB,EAChBE,gBAAiB,OATZQ,OAAMC,cAYbC,aAAU,eACFC,GAAkBf,MAAAA,SAAAA,EAAKgB,UAAWf,EACxCgB,QAAQC,IAAIH,OACNI,EAAcjB,IAAkBa,MAAAA,SAAAA,EAAiBK,aACjDC,EAAejB,IAAmBW,MAAAA,SAAAA,EAAiBO,cACzDL,QAAQC,IAAIC,EAAaE,OACnBE,EAAcJ,EAAcE,KAE7BvB,OACC0B,EAAMC,SAASC,cAAc,OACnCF,EAAIG,iBAAiB,QAAQ,SAACC,SACYA,EAAEC,OAAlCC,IAAAA,cAAeC,IAAAA,aACvBd,QAAQC,IAAIa,EAAcD,OAEtB3B,EACFE,EAFIE,EAAQwB,EAAeD,EAG3BtB,EAAU,EACVC,EAAU,KAEC,UAATZ,KACEU,GAASgB,EAAa,KAClBS,EAAQX,EAAeS,EAC7Bb,QAAQC,IAAIc,GAEZxB,GAAWW,GADXhB,EAAQ4B,EAAeC,IACW,EAClC3B,EAASgB,MACJ,CAELlB,EAAQgB,EAERV,GAAWY,GADXhB,EAASyB,GAFKX,EAAcY,KAGQ,OAEjC,GAAa,YAATlC,EAAoB,IACzBU,GAASgB,EAEXpB,EAAQgB,EAGRV,GAAWY,GAFXhB,EAASyB,GAFKX,EAAcY,KAIQ,OAGpC1B,EAASgB,EAETb,GAAWW,GADXhB,EAAQ4B,GAFMV,EAAeS,KAGK,EAItCjB,EAAQ,CACNV,MAAAA,EACAE,OAAAA,EACAE,MAAAA,EACAC,QAAAA,EACAC,QAAAA,EACAC,SAAUqB,EACVpB,UAAWmB,EACX5B,eAAgBiB,EAChBf,gBAAiBiB,OAGrBG,EAAIS,IAAMnC,KACT,CAACD,EAAMC,EAAQE,EAAKC,EAAKC,EAAgBE,IAErCQ"}